<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#f8fafc">
    <title>Agenda T√°ctica 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; user-select: none; }
        .bg-pattern { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 32px 32px; opacity: 0.3; pointer-events: none; z-index: 0; }
        .timeline-track { position: absolute; left: 4rem; top: 0; bottom: 0; width: 2px; background: linear-gradient(to bottom, #e2e8f0 0%, #cbd5e1 100%); z-index: 0; border-radius: 99px; }
        .event-card { transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer; }
        .event-card:active { transform: scale(0.98); opacity: 0.9; }
        .skipped-card { opacity: 0.5 !important; filter: grayscale(100%) !important; }
        .skipped-text { text-decoration: line-through !important; color: #94a3b8 !important; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        .pt-safe { padding-top: env(safe-area-inset-top); }
        
        /* ESTILOS DEL ASISTENTE T√âCNICO (COPILOT) */
        .copilot-bubble { 
            background: #fff; 
            border: 1px solid #e0e7ff;
            font-size: 0.75rem; 
            color: #4f46e5; 
            position: relative; 
            margin-left: 4.5rem; /* Ajustado para alinear con tarjetas */
            margin-bottom: 1rem; 
            margin-right: 1rem;
            padding: 0.75rem 1rem; 
            border-radius: 1rem; 
            border-top-left-radius: 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02);
            animation: fadeIn 0.5s ease-out;
        }
        .copilot-icon {
            position: absolute; left: -1.75rem; top: 50%; transform: translateY(-50%);
            background: #6366f1; color: white; width: 1.5rem; height: 1.5rem;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 0.7rem; z-index: 10; box-shadow: 0 0 0 4px #f8fafc;
        }
        
        .glass-nav { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(16px); border-top: 1px solid rgba(0,0,0,0.03); }
        .live-glow { animation: pulse-soft 2s infinite; border-color: #818cf8 !important; }
        @keyframes pulse-soft { 0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.2); } 70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); } 100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .goal-card { transition: all 0.3s ease; border: 1px solid #e2e8f0; }
        .goal-card.done { opacity: 0.6; background-color: #f8fafc; border-color: #f1f5f9; }
        .goal-card.done h4 { text-decoration: line-through; color: #94a3b8; }
        .progress-bar-striped { background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent); background-size: 1rem 1rem; }
        .action-btn { cursor: pointer; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
        .btn-confirm-delete { background-color: #ef4444 !important; color: white !important; border-color: #ef4444 !important; transition: all 0.2s ease; }
        .cat-select { position: relative; }
        .cat-delete-btn { position: absolute; top: -6px; right: -6px; width: 18px; height: 18px; background: #ef4444; color: white; border-radius: 50%; font-size: 10px; display: flex; align-items: center; justify-content: center; z-index: 20; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 2px solid white; cursor: pointer; }
        .checklist-item-actions { opacity: 0.6; transition: opacity 0.2s; }
        .group:hover .checklist-item-actions { opacity: 1; }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden relative bg-slate-50">

    <div class="bg-pattern"></div>

    <!-- HEADER -->
    <header class="bg-white/80 backdrop-blur-xl px-6 pt-safe pb-4 sticky top-0 z-30 border-b border-slate-100">
        <div class="flex justify-between items-center mt-2">
            <div class="flex items-center gap-3 cursor-pointer group action-btn" onclick="toggleWeekMenu()">
                <div class="bg-slate-900 text-white p-3 rounded-2xl shadow-lg shadow-slate-200 group-active:scale-95 transition">
                    <i class="fas fa-layer-group text-sm"></i>
                </div>
                <div>
                    <h1 class="text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-none mb-1">PLAN 2026</h1>
                    <div class="flex items-center gap-1.5">
                        <span id="current-week-label" class="font-bold text-base text-slate-800 leading-none">Semana 1</span>
                        <i class="fas fa-chevron-down text-[10px] text-slate-300"></i>
                    </div>
                    <span id="current-week-date" class="text-[10px] text-slate-400 font-medium mt-0.5 block">--</span>
                </div>
            </div>
            
            <div class="flex flex-col items-end gap-1.5">
                <button onclick="generateDailyBriefing()" class="action-btn bg-white hover:bg-slate-50 text-indigo-600 border border-indigo-100 px-3 py-1.5 rounded-full text-[10px] font-bold shadow-sm flex items-center gap-1.5 transition active:scale-95">
                    <i class="fas fa-robot text-indigo-500"></i> BRIEFING
                </button>
                <div class="flex gap-2">
                     <span class="text-[9px] bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full font-bold">PUCP: <span id="days-pucp">--</span></span>
                     <span class="text-[9px] bg-red-50 text-red-600 px-2 py-0.5 rounded-full font-bold">BOMBA: <span id="days-fire">--</span></span>
                </div>
            </div>
        </div>
        <div class="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden mt-5">
            <div id="day-progress" class="bg-gradient-to-r from-blue-400 to-indigo-500 h-full rounded-full transition-all duration-1000" style="width: 0%"></div>
        </div>
    </header>

    <!-- MENU SEMANAL -->
    <div id="week-menu" class="hidden absolute top-28 left-0 w-full bg-white/95 backdrop-blur-xl z-40 shadow-[0_20px_40px_-15px_rgba(0,0,0,0.1)] border-b border-slate-100 rounded-b-[2rem] transition-all">
        <div class="p-5 border-b border-slate-100 flex justify-between items-center">
            <span class="text-xs font-bold uppercase text-slate-400 tracking-wider">Navegar</span>
            <button onclick="jumpToCurrentWeek()" class="action-btn text-xs bg-slate-900 text-white px-4 py-2 rounded-full font-bold shadow hover:bg-slate-800 transition">Ir a Hoy</button>
        </div>
        <div class="p-4 grid grid-cols-1 gap-2 max-h-[50vh] overflow-y-auto" id="week-list-container"></div>
    </div>

    <!-- AREA PRINCIPAL -->
    <main class="flex-1 overflow-y-auto relative z-10 w-full scroll-smooth" id="main-scroll">
        <div id="ai-briefing-container" class="hidden mx-5 mt-5 mb-2 p-5 bg-white border border-indigo-50 rounded-3xl shadow-sm relative animate-fade-in-down">
            <button onclick="document.getElementById('ai-briefing-container').classList.add('hidden')" class="action-btn absolute top-4 right-4 text-slate-300 hover:text-slate-500"><i class="fas fa-times text-sm"></i></button>
            <div class="flex gap-4">
                <div class="mt-1 bg-indigo-50 w-10 h-10 rounded-full flex items-center justify-center shrink-0"><i class="fas fa-satellite-dish text-indigo-500"></i></div>
                <div>
                    <h4 class="text-[10px] font-bold text-indigo-400 uppercase tracking-widest mb-1.5">Informe de Misi√≥n</h4>
                    <p id="ai-briefing-text" class="text-sm text-slate-600 leading-relaxed font-medium">Analizando...</p>
                </div>
            </div>
        </div>

        <div class="sticky top-0 bg-[#f8fafc]/95 backdrop-blur-md z-20 px-6 pt-6 pb-2 transition-all">
            <div class="flex justify-between items-start mb-2">
                <div>
                    <h2 id="day-display-title" class="text-3xl font-black text-slate-900 tracking-tight capitalize leading-none">--</h2>
                    <p id="day-display-subtitle" class="text-sm text-slate-500 font-medium mt-1">--</p>
                </div>
                <div class="flex flex-col items-end">
                     <div id="date-display" class="text-xs font-bold text-slate-500 bg-white px-3 py-1.5 rounded-xl shadow-sm border border-slate-100">--</div>
                </div>
            </div>
        </div>

        <div class="px-5 py-6 pb-36 relative min-h-full" id="timeline-container"></div>
    </main>

    <!-- NAVEGACI√ìN INFERIOR -->
    <nav class="glass-nav pb-safe shrink-0 z-30 fixed bottom-0 w-full shadow-[0_-10px_40px_rgba(0,0,0,0.03)]">
        <div class="flex justify-between px-6 py-3 overflow-x-auto hide-scrollbar gap-2" id="bottom-nav"></div>
    </nav>

    <!-- BOTONES FLOTANTES -->
    <div class="fixed bottom-28 right-6 flex flex-col gap-4 z-40 pointer-events-none">
        <button onclick="openWarehouseModal()" class="action-btn pointer-events-auto w-14 h-14 bg-white text-slate-600 rounded-full shadow-xl shadow-slate-300/30 flex items-center justify-center border border-slate-100 active:scale-90 transition transform hover:-translate-y-1">
            <i class="fas fa-box-archive text-lg"></i>
        </button>
        <button onclick="openGoalsModal()" class="action-btn pointer-events-auto w-14 h-14 bg-white text-yellow-500 rounded-full shadow-xl shadow-yellow-500/10 flex items-center justify-center border border-yellow-50 active:scale-90 transition transform hover:-translate-y-1">
            <i class="fas fa-trophy text-lg"></i>
        </button>
        <button onclick="openAddModal()" class="action-btn pointer-events-auto w-16 h-16 bg-slate-900 text-white rounded-[20px] shadow-2xl shadow-slate-900/30 flex items-center justify-center transition transform hover:scale-105 active:scale-95">
            <i class="fas fa-plus text-2xl"></i>
        </button>
    </div>

    <!-- MODAL PRINCIPAL -->
    <div id="modal-overlay" class="fixed inset-0 bg-slate-900/30 z-50 hidden flex flex-col justify-end backdrop-blur-sm transition-opacity duration-300" onclick="if(event.target === this) closeModal()">
        <div class="bg-white w-full rounded-t-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] transition-transform transform translate-y-full" id="modal-card">
            <div class="px-8 py-6 flex justify-between items-center bg-white sticky top-0 z-20 border-b border-slate-50">
                <div>
                    <h3 class="font-bold text-2xl text-slate-900 leading-none" id="modal-title">Detalles</h3>
                    <p class="text-sm text-slate-400 font-medium mt-1" id="modal-time-range">--</p>
                </div>
                <button onclick="closeModal()" class="action-btn w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-slate-100 transition"><i class="fas fa-times text-lg"></i></button>
            </div>

            <div class="p-8 overflow-y-auto bg-white pb-safe">
                <!-- VISTA DETALLE -->
                <div id="view-mode-content" class="hidden space-y-8">
                    <button onclick="generateStrategy()" id="ai-btn" class="action-btn w-full py-4 bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-100 text-indigo-600 rounded-2xl shadow-sm flex items-center justify-center gap-2 font-bold text-xs hover:brightness-95 transition group">
                        <span class="relative z-10 flex items-center gap-2"><i class="fas fa-magic text-indigo-500"></i> <span id="ai-btn-text">GENERAR ESTRATEGIA</span></span>
                    </button>
                    
                    <div>
                        <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">Checklist T√°ctico</h4>
                        <ul id="checklist-container" class="space-y-3"></ul>
                        <div class="flex gap-2 mt-4">
                            <input type="text" id="new-check-item" placeholder="Agregar pendiente..." class="flex-1 text-sm p-3 bg-slate-50 border-0 rounded-xl placeholder-slate-400">
                            <button onclick="addCheckItem()" class="action-btn w-11 h-11 bg-slate-900 text-white rounded-xl flex items-center justify-center shadow-lg active:scale-95 transition"><i class="fas fa-plus"></i></button>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-3 pt-2">
                        <button onclick="enableEditMode()" class="action-btn py-4 bg-white border border-slate-200 text-slate-600 font-bold text-xs rounded-2xl hover:bg-slate-50 transition active:scale-95">EDITAR</button>
                        <button onclick="skipEvent()" class="action-btn py-4 bg-amber-50 border border-amber-100 text-amber-600 font-bold text-xs rounded-2xl hover:bg-amber-100 transition active:scale-95">SALTAR</button>
                        <button id="btn-delete-event" onclick="deleteEvent(this)" class="action-btn py-4 bg-white border border-red-100 text-red-500 font-bold text-xs rounded-2xl hover:bg-red-50 transition active:scale-95">BORRAR</button>
                    </div>
                    
                    <div id="live-controls" class="hidden pt-2">
                        <button onclick="finishEventNow()" class="action-btn w-full py-4 bg-green-500 text-white font-bold rounded-2xl shadow-lg shadow-green-200 hover:bg-green-600 transition flex items-center justify-center gap-2 active:scale-95">
                            <i class="fas fa-check-circle"></i> TERMINAR AHORA
                        </button>
                    </div>
                </div>

                <!-- GAPS & FORM -->
                <div id="gap-mode-content" class="hidden space-y-6">
                    <div class="text-center mb-6">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-50 text-blue-600 mb-4"><i class="fas fa-stopwatch text-2xl"></i></div>
                        <h3 class="text-2xl font-black text-slate-900 tracking-tight">Tiempo Libre</h3>
                        <p class="text-sm text-slate-500 mt-1">Tienes <span id="gap-duration" class="font-bold text-slate-900">-- min</span> disponibles.</p>
                    </div>
                    <div id="gap-suggestions-grid" class="grid grid-cols-1 gap-3"></div>
                </div>

                <form id="event-form" class="space-y-6 hidden">
                    <input type="hidden" id="event-id">
                    <input type="hidden" id="warehouse-origin-id">
                    <div>
                        <label class="text-[10px] font-bold text-slate-400 uppercase mb-2 block pl-1">T√≠tulo</label>
                        <input type="text" id="input-title" class="w-full text-xl font-bold text-slate-800 placeholder-slate-300 p-4 bg-slate-50 rounded-2xl border-0" required>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="text-[10px] font-bold text-slate-400 uppercase mb-2 block pl-1">Inicio</label><input type="time" id="input-start" class="w-full p-4 bg-slate-50 rounded-2xl font-mono text-sm font-bold text-slate-700 border-0" required></div>
                        <div><label class="text-[10px] font-bold text-slate-400 uppercase mb-2 block pl-1">Fin</label><input type="time" id="input-end" class="w-full p-4 bg-slate-50 rounded-2xl font-mono text-sm font-bold text-slate-700 border-0"></div>
                    </div>
                    <div>
                        <div class="flex justify-between items-center mb-3 px-1">
                            <label class="text-[10px] font-bold text-slate-400 uppercase">Categor√≠a</label>
                            
                            <!-- Bot√≥n Original -->
                            <button id="btn-add-cat" type="button" onclick="window.toggleNewCatUI()" class="action-btn text-[10px] font-bold text-blue-600 hover:underline transition">+ Nueva</button>
                            
                            <!-- Input Inline -->
                            <div id="input-add-cat-group" class="hidden flex items-center gap-1">
                                <input type="text" id="input-new-cat-emoji" placeholder="Icono" class="w-8 text-[10px] p-1.5 border border-slate-200 rounded-lg bg-slate-50 text-center focus:bg-white outline-none" value="‚ö°">
                                <input type="text" id="input-new-cat-name" placeholder="Nombre..." class="w-20 text-[10px] p-1.5 border border-slate-200 rounded-lg bg-slate-50 focus:bg-white outline-none">
                                <button type="button" onclick="window.saveNewCategory()" class="bg-slate-900 text-white text-[10px] px-2 py-1.5 rounded-lg font-bold"><i class="fas fa-check"></i></button>
                                <button type="button" onclick="window.toggleNewCatUI()" class="text-slate-400 hover:text-slate-600 px-1"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2" id="category-grid"></div>
                        <input type="hidden" id="input-cat" value="casa">
                    </div>
                    <button type="submit" class="action-btn w-full py-4 bg-slate-900 text-white font-bold rounded-2xl shadow-xl shadow-slate-900/20 hover:bg-slate-800 transition active:scale-95 flex justify-center items-center gap-2"><span>Guardar Actividad</span></button>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL METAS Y ALMAC√âN -->
    <div id="goals-overlay" class="fixed inset-0 bg-slate-900/40 z-50 hidden flex flex-col justify-end backdrop-blur-sm transition-opacity duration-300" onclick="if(event.target === this) closeGoalsModal()">
        <div class="bg-white w-full rounded-t-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transition-transform transform translate-y-full" id="goals-card">
            <div class="px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-20">
                <div><h3 class="font-bold text-2xl text-slate-900 leading-none">Metas 2026</h3></div>
                <button onclick="closeGoalsModal()" class="action-btn w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-slate-100 transition"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="p-8 overflow-y-auto bg-white pb-safe">
                <div class="space-y-4 mb-8" id="goals-list-container"></div>
                <div class="bg-slate-50 p-6 rounded-3xl border border-slate-100">
                    <h4 class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-4">Nueva Meta</h4>
                    <div class="flex gap-2 mb-4 bg-white p-1 rounded-xl border border-slate-100">
                        <button onclick="toggleGoalType('simple')" id="btn-type-simple" class="action-btn flex-1 py-3 rounded-lg text-sm font-bold bg-slate-900 text-white transition shadow-sm">Logro üèÜ</button>
                        <button onclick="toggleGoalType('savings')" id="btn-type-savings" class="action-btn flex-1 py-3 rounded-lg text-sm font-bold text-slate-400 hover:bg-slate-50 transition">Ahorro üí∞</button>
                    </div>
                    <input type="text" id="new-goal-title" placeholder="Ej: Licencia A1" class="w-full text-base font-medium p-3 bg-white border border-slate-200 rounded-xl mb-3">
                    <div id="savings-inputs" class="hidden grid grid-cols-2 gap-3 mb-3">
                        <input type="number" id="new-goal-target" placeholder="Meta S/." class="w-full text-sm p-3 bg-white border border-slate-200 rounded-xl">
                        <input type="number" id="new-goal-current" placeholder="Inicio S/." class="w-full text-sm p-3 bg-white border border-slate-200 rounded-xl">
                    </div>
                    <button onclick="addNewGoal()" class="action-btn w-full py-4 bg-yellow-400 text-yellow-900 rounded-xl font-bold shadow-lg shadow-yellow-400/20 active:scale-95 transition">Crear Meta</button>
                </div>
            </div>
        </div>
    </div>

    <div id="warehouse-overlay" class="fixed inset-0 bg-slate-900/40 z-50 hidden flex flex-col justify-end backdrop-blur-sm transition-opacity duration-300" onclick="if(event.target === this) closeWarehouseModal()">
        <div class="bg-white w-full rounded-t-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transition-transform transform translate-y-full" id="warehouse-card">
            <div class="px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-20">
                <div><h3 class="font-bold text-2xl text-slate-900 leading-none">Almac√©n</h3></div>
                <button onclick="closeWarehouseModal()" class="action-btn w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-slate-100 transition"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="p-8 overflow-y-auto bg-white pb-safe">
                <div class="flex gap-2 overflow-x-auto hide-scrollbar mb-6 pb-2" id="warehouse-tags">
                    <button onclick="filterWarehouse('all')" class="action-btn px-4 py-2 rounded-full bg-slate-900 text-white text-xs font-bold shrink-0 transition" id="filter-all">Todo</button>
                    <button onclick="filterWarehouse('ideas')" class="action-btn px-4 py-2 rounded-full bg-slate-100 text-slate-500 text-xs font-bold shrink-0 hover:bg-yellow-100 hover:text-yellow-600 transition" id="filter-ideas">Ideas</button>
                    <button onclick="filterWarehouse('compras')" class="action-btn px-4 py-2 rounded-full bg-slate-100 text-slate-500 text-xs font-bold shrink-0 hover:bg-green-100 hover:text-green-600 transition" id="filter-compras">Compras</button>
                    <button onclick="filterWarehouse('links')" class="action-btn px-4 py-2 rounded-full bg-slate-100 text-slate-500 text-xs font-bold shrink-0 hover:bg-blue-100 hover:text-blue-600 transition" id="filter-links">Links</button>
                    <button onclick="filterWarehouse('otros')" class="action-btn px-4 py-2 rounded-full bg-slate-100 text-slate-500 text-xs font-bold shrink-0 hover:bg-purple-100 hover:text-purple-600 transition" id="filter-otros">Otros</button>
                </div>
                <div class="flex gap-2 mb-6">
                    <div class="relative flex-1">
                        <input type="text" id="warehouse-input" placeholder="Vaciar la mente..." class="w-full bg-slate-50 border border-slate-200 rounded-2xl p-4 pr-12 text-sm font-medium focus:bg-white transition" onkeypress="if(event.key === 'Enter') addToWarehouse()">
                        <div class="absolute right-3 top-1/2 -translate-y-1/2">
                            <select id="warehouse-cat-select" class="text-xs bg-transparent border-none text-slate-400 font-bold focus:outline-none text-right cursor-pointer">
                                <option value="ideas">üí°</option>
                                <option value="compras">üõí</option>
                                <option value="links">üîó</option>
                                <option value="otros">üì¶</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="addToWarehouse()" class="action-btn w-14 bg-slate-900 text-white rounded-2xl shadow-lg active:scale-95 transition flex items-center justify-center"><i class="fas fa-arrow-up"></i></button>
                </div>
                <div class="space-y-3 min-h-[200px]" id="warehouse-list"></div>
            </div>
        </div>
    </div>

    <!-- LOGICA -->
    <script>
        const apiKey = ""; 
        const YEAR_START_DATE = new Date("2025-12-29T00:00:00"); 
        
        const defaultCats = {
            fisico: { label: "F√≠sico", color: "green", icon: "fa-dumbbell" },
            estudio: { label: "Estudio", color: "blue", icon: "fa-book" },
            bomba: { label: "Bomberos", color: "red", icon: "fa-fire-extinguisher" },
            casa: { label: "Casa", color: "amber", icon: "fa-home" },
            social: { label: "Social", color: "purple", icon: "fa-heart" },
            traslado: { label: "Traslado", color: "slate", icon: "fa-bus" },
            aseo: { label: "Aseo", color: "cyan", icon: "fa-spray-can" }
        };

        const templateWeek = {
            lunes: { title: "Carga M√°xima", items: [
                {id: "1", start:"05:00", end:"05:15", cat:"aseo", title:"Despertar", desc:"Aseo R√°pido (Cara/Dientes)", check:[]},
                {id: "2", start:"05:15", end:"06:00", cat:"fisico", title:"Running (Solo)", desc:"Resistencia", check:[]},
                {id: "3", start:"06:00", end:"06:30", cat:"aseo", title:"Ducha + Skincare", desc:"Aseo Personal Completo", check:[]},
                {id: "4", start:"06:30", end:"07:15", cat:"casa", title:"Chef: Cocina", desc:"Preparar Desayuno + Almuerzo Taper", check:[]},
                {id: "5", start:"07:15", end:"07:45", cat:"casa", title:"Desayuno", desc:"Comer tranquilo", check:[]},
                {id: "6", start:"07:45", end:"08:00", cat:"traslado", title:"Alistar Mochila", desc:"Salida", check:[]},
                {id: "7", start:"08:00", end:"10:00", cat:"estudio", title:"Estudio / Gesti√≥n", desc:"Opcional Bomberos / Tareas", check:[]},
                {id: "8", start:"10:30", end:"12:00", cat:"fisico", title:"Piscina", desc:"Cardio Suave", check:[]},
                {id: "9", start:"12:30", end:"13:30", cat:"casa", title:"Almuerzo Solo", desc:"Calle", check:[]},
                {id: "10", start:"13:30", end:"17:30", cat:"estudio", title:"Biblioteca PUCP", desc:"Estudio Puro", check:[]},
                {id: "11", start:"18:00", end:"20:00", cat:"fisico", title:"Gimnasio", desc:"Fuerza", check:[]},
                {id: "12", start:"20:00", end:"21:00", cat:"casa", title:"Cena", desc:"Comida Fija", check:[]},
                {id: "13", start:"21:00", end:"22:00", cat:"casa", title:"Check Servicio", desc:"Lavar lo sucio / Ordenar", check:[]},
                {id: "14", start:"22:00", end:"22:15", cat:"casa", title:"DESCONEXI√ìN", desc:"Apagar pantallas", check:[{text:"Modo Avi√≥n", done:false}]},
                {id: "15", start:"22:15", end:"23:59", cat:"casa", title:"Dormir", desc:"Descanso", check:[]}
            ]},
            martes: { title: "Acad√©mico", items: [
                {id: "16", start:"05:00", end:"05:15", cat:"aseo", title:"Despertar", desc:"Aseo R√°pido", check:[]},
                {id: "17", start:"05:15", end:"06:00", cat:"fisico", title:"Caminata Gym", desc:"Ir al gym", check:[]},
                {id: "18", start:"06:00", end:"07:30", cat:"fisico", title:"GIMNASIO", desc:"Apertura 6AM", check:[]},
                {id: "19", start:"07:30", end:"08:00", cat:"aseo", title:"Ducha R√°pida + Skincare", desc:"Regreso", check:[]},
                {id: "20", start:"08:00", end:"08:45", cat:"casa", title:"Desayuno", desc:"Comida", check:[]},
                {id: "21", start:"09:00", end:"11:00", cat:"estudio", title:"Clase Se√±as", desc:"Virtual", check:[]},
                {id: "22", start:"11:00", end:"13:00", cat:"estudio", title:"Ingl√©s / Repaso", desc:"Casa", check:[]},
                {id: "23", start:"13:00", end:"14:00", cat:"casa", title:"Almuerzo", desc:"Comida Fija", check:[]},
                {id: "24", start:"14:30", end:"17:30", cat:"estudio", title:"Biblioteca", desc:"Letras", check:[]},
                {id: "25", start:"18:45", end:"22:00", cat:"bomba", title:"Guardia Noche", desc:"Servicio", check:[{text:"Cena llevada", done:false}]},
                {id: "26", start:"22:00", end:"22:15", cat:"casa", title:"DESCONEXI√ìN", desc:"", check:[]}
            ]},
            miercoles: { title: "Simulacro", items: [
                {id: "27", start:"05:00", end:"05:15", cat:"aseo", title:"Despertar", desc:"Aseo R√°pido", check:[]},
                {id: "28", start:"05:15", end:"06:00", cat:"fisico", title:"Running + Perro", desc:"Parque", check:[]},
                {id: "29", start:"06:00", end:"06:30", cat:"aseo", title:"Ducha", desc:"", check:[]},
                {id: "30", start:"06:30", end:"08:30", cat:"casa", title:"LIMPIEZA PROFUNDA", desc:"Lavander√≠a + Cocina", check:[]},
                {id: "31", start:"08:30", end:"09:00", cat:"casa", title:"Desayuno", desc:"", check:[]},
                {id: "32", start:"09:30", end:"12:30", cat:"estudio", title:"SIMULACRO PUCP", desc:"Condiciones Reales", check:[]},
                {id: "33", start:"12:30", end:"13:30", cat:"casa", title:"Almuerzo", desc:"Comida Fija", check:[]},
                {id: "34", start:"14:00", end:"18:00", cat:"estudio", title:"App Bomberos", desc:"Programaci√≥n", check:[]},
                {id: "35", start:"18:15", end:"20:00", cat:"fisico", title:"Gimnasio", desc:"Pesas", check:[]},
                {id: "36", start:"20:00", end:"21:00", cat:"casa", title:"Cena", desc:"", check:[]},
                {id: "37", start:"22:00", end:"22:15", cat:"casa", title:"DESCONEXI√ìN", desc:"", check:[]}
            ]},
            jueves: { title: "Voluntariado", items: [
                {id: "38", start:"05:00", end:"05:15", cat:"aseo", title:"Despertar", desc:"", check:[]},
                {id: "39", start:"05:15", end:"06:00", cat:"fisico", title:"Funcional Casa", desc:"Sin Gym tarde", check:[]},
                {id: "40", start:"06:00", end:"06:30", cat:"aseo", title:"Ducha", desc:"", check:[]},
                {id: "41", start:"06:30", end:"07:00", cat:"casa", title:"Desayuno/Sala", desc:"Limpieza Sala R√°pida", check:[]},
                {id: "42", start:"07:00", end:"08:30", cat:"traslado", title:"Viaje Chorrillos", desc:"Audio Ingl√©s", check:[]},
                {id: "43", start:"08:30", end:"11:30", cat:"social", title:"Voluntariado", desc:"Alto Per√∫", check:[]},
                {id: "44", start:"11:30", end:"13:00", cat:"traslado", title:"Retorno/Almuerzo", desc:"Comer en ruta", check:[]},
                {id: "45", start:"13:30", end:"17:30", cat:"estudio", title:"Biblioteca", desc:"Foco PUCP", check:[]},
                {id: "46", start:"18:45", end:"22:00", cat:"bomba", title:"Guardia Noche", desc:"", check:[]},
                {id: "47", start:"22:00", end:"22:15", cat:"casa", title:"DESCONEXI√ìN", desc:"", check:[]}
            ]},
            viernes: { title: "Remate", items: [
                {id: "48", start:"05:00", end:"05:15", cat:"aseo", title:"Despertar", desc:"", check:[]},
                {id: "49", start:"05:15", end:"06:00", cat:"fisico", title:"Running", desc:"Fondo", check:[]},
                {id: "50", start:"06:00", end:"06:30", cat:"aseo", title:"Ducha", desc:"", check:[]},
                {id: "51", start:"06:30", end:"07:30", cat:"casa", title:"Chef (Cocina)", desc:"Cocina interdiaria", check:[]},
                {id: "52", start:"07:30", end:"08:00", cat:"casa", title:"Desayuno", desc:"", check:[]},
                {id: "53", start:"08:00", end:"10:00", cat:"estudio", title:"Estudio / Gesti√≥n", desc:"", check:[]},
                {id: "54", start:"10:30", end:"12:00", cat:"fisico", title:"Piscina", desc:"Cardio", check:[]},
                {id: "55", start:"12:30", end:"13:30", cat:"casa", title:"Almuerzo", desc:"Comida Fija", check:[]},
                {id: "56", start:"14:00", end:"18:00", cat:"estudio", title:"App Farmacia", desc:"Proyecto Novia", check:[]},
                {id: "57", start:"18:15", end:"20:00", cat:"fisico", title:"Gimnasio", desc:"Fuerza Pierna", check:[]},
                {id: "58", start:"20:00", end:"21:00", cat:"casa", title:"Cena", desc:"", check:[]},
                {id: "59", start:"22:00", end:"22:15", cat:"casa", title:"DESCONEXI√ìN", desc:"", check:[]}
            ]},
            sabado: { title: "Pareja", items: [
                {id: "60", start:"06:00", end:"07:00", cat:"casa", title:"Aseo + Desayuno", desc:"R√°pido", check:[]},
                {id: "61", start:"07:00", end:"08:00", cat:"traslado", title:"Salida c/ Mam√°", desc:"Ahorro", check:[]},
                {id: "62", start:"08:00", end:"13:00", cat:"estudio", title:"Estudio Fuera", desc:"Caf√©/Biblio", check:[]},
                {id: "63", start:"13:00", end:"14:00", cat:"casa", title:"Almuerzo", desc:"Calle", check:[]},
                {id: "64", start:"14:00", end:"16:00", cat:"social", title:"Gym Pareja", desc:"Con Novia", check:[]},
                {id: "65", start:"16:30", end:"18:00", cat:"casa", title:"Lavander√≠a 2", desc:"Opcional tarde", check:[]},
                {id: "66", start:"18:00", end:"23:00", cat:"social", title:"Cita Novia", desc:"Calidad", check:[]},
                {id: "68", start:"23:00", end:"23:15", cat:"casa", title:"DESCONEXI√ìN", desc:"Buenas noches", check:[]}
            ]},
            domingo: { title: "Guardia", items: [
                {id: "69", start:"05:30", end:"06:00", cat:"aseo", title:"Despertar + Aseo", desc:"Preparar Uniforme", check:[{text:"Botas", done:false}]},
                {id: "70", start:"06:00", end:"07:00", cat:"traslado", title:"Traslado Bomba", desc:"Llegar antes", check:[]},
                {id: "71", start:"07:00", end:"21:00", cat:"bomba", title:"GUARDIA TOTAL", desc:"14h. Comidas all√≠.", check:[{text:"Llevar libros", done:false}, {text:"Taper Desayuno", done:false}, {text:"Taper Almuerzo", done:false}]},
                {id: "72", start:"21:00", end:"22:00", cat:"traslado", title:"Retorno Casa", desc:"", check:[]},
                {id: "73", start:"22:00", end:"22:15", cat:"casa", title:"DESCONEXI√ìN", desc:"Aseo + Dormir", check:[]}
            ]}
        };

        const dayLabels = { lunes: "Lun", martes: "Mar", miercoles: "Mi√©", jueves: "Jue", viernes: "Vie", sabado: "S√°b", domingo: "Dom" };
        const dayMap = {lunes:0, martes:1, miercoles:2, jueves:3, viernes:4, sabado:5, domingo:6};
        
        let appData = { weeks: {}, categories: defaultCats, currentWeekId: "semana-1", currentDayKey: "lunes", goals: [], warehouse: [] };
        let activeEvent = null;
        let activeFilter = 'all';
        let newGoalType = 'simple';
        let touchStartX = 0; let touchEndX = 0;
        let activeGapStart = 0;
        let deleteConfirmState = false; 
        let deleteGoalConfirmState = false;

        // GLOBALS
        window.timeToMins = function(t) { const [h,m] = t.split(':').map(Number); return h*60+m; }
        window.minsToTime = function(m) { let h=Math.floor(m/60)%24; let mn=m%60; return `${String(h).padStart(2,'0')}:${String(mn).padStart(2,'0')}`; }
        window.getNowMins = function() { const d = new Date(); return d.getHours()*60 + d.getMinutes(); }
        window.setNow = function(id) { const d=new Date(); document.getElementById(id).value = `${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`; }
        window.saveData = function() { localStorage.setItem('agenda2026_vFINAL_RESTORED', JSON.stringify(appData)); }

        // --- ASISTENTE T√âCNICO (COPILOT) ---
        window.getTransitionTip = function(prev, next) {
            if (prev.cat === 'fisico' && next.cat === 'aseo') return `üí¶ <strong>Post-Entreno:</strong> Alista toalla y muda limpia.`;
            if (prev.cat === 'aseo' && next.title.includes('Chef')) return `üë®‚Äçüç≥ <strong>Cocina:</strong> Pon m√∫sica y revisa ingredientes.`;
            if (prev.cat === 'fisico' && next.title.includes('Chef')) return `ü•ó <strong>Recarga:</strong> Bebe agua y pon a hervir lo que necesites.`;
            if (next.cat === 'traslado') return `üéí <strong>Salida:</strong> ¬øLlaves, billetera, aud√≠fonos?`;
            if (next.cat === 'bomba') return `üöí <strong>Mentalidad:</strong> Uniforme impecable. DNI listo.`;
            if (prev.cat === 'estudio' && next.cat === 'fisico') return `‚ö° <strong>Cambio:</strong> Cierra libros, activa playlist.`;
            return null;
        }

        window.init = function() {
            const saved = localStorage.getItem('agenda2026_vFINAL_RESTORED');
            if(saved) {
                try {
                    appData = JSON.parse(saved);
                    if (!appData.categories) appData.categories = defaultCats;
                    else appData.categories = { ...defaultCats, ...appData.categories };
                } catch(e) { window.generateFullYear(); }
            } else {
                window.generateFullYear();
            }
            window.setCurrentDay();
            window.render();
            window.setupEventListeners();
            window.setupSwipe();
            setInterval(window.updateHeader, 60000);
        }

        window.generateFullYear = function() {
            for(let i=1; i<=52; i++) {
                appData.weeks[`semana-${i}`] = JSON.parse(JSON.stringify(templateWeek));
            }
            window.saveData();
        }

        window.setCurrentDay = function() {
            const today = new Date();
            const dayIdx = today.getDay();
            appData.currentDayKey = ['domingo', 'lunes', 'martes', 'miercoles', 'jueves', 'viernes', 'sabado'][dayIdx];
            const start = new Date(YEAR_START_DATE);
            const diff = today - start;
            const weekNum = Math.ceil((diff / 86400000 + 1) / 7);
            if(weekNum > 0 && weekNum <= 53) appData.currentWeekId = `semana-${weekNum}`;
        }

        window.render = function() { window.renderWeekMenu(); window.renderNav(); window.renderCategories(); window.renderTimeline(); window.updateHeader(); }

        window.renderTimeline = function() {
            const items = appData.weeks[appData.currentWeekId][appData.currentDayKey].items;
            items.sort((a,b) => window.timeToMins(a.start) - window.timeToMins(b.start));
            
            const container = document.getElementById('timeline-container');
            container.innerHTML = '<div class="timeline-track"></div>';
            
            if(items.length === 0) {
                container.innerHTML += `<div class="text-center p-10 text-slate-400 italic">D√≠a Libre</div>`;
                return;
            }

            let lastEndTime = 0;
            const nowMins = window.getNowMins();

            items.forEach((item, index) => {
                const catData = appData.categories[item.cat] || defaultCats.casa;
                const iconHTML = catData.icon.startsWith('fa-') ? `<i class="fas ${catData.icon}"></i>` : `<span>${catData.icon}</span>`;
                
                let borderClass = `border-${catData.color}-500`;
                let iconClass = `text-${catData.color}-600`;
                const map = { green: {b:"border-green-500", i:"text-green-600"}, blue: {b:"border-blue-500", i:"text-blue-600"}, red: {b:"border-red-500", i:"text-red-600"}, amber: {b:"border-amber-500", i:"text-amber-600"}, purple: {b:"border-purple-500", i:"text-purple-600"}, slate: {b:"border-slate-500", i:"text-slate-600"}, cyan: {b:"border-cyan-400", i:"text-cyan-600"} };
                if(map[catData.color]) { borderClass = map[catData.color].b; iconClass = map[catData.color].i; } else { borderClass = "border-gray-300"; iconClass = "text-gray-400"; }

                const startMins = window.timeToMins(item.start);
                
                if (index > 0) {
                    const prevItem = items[index - 1];
                    const gap = startMins - lastEndTime;
                    if (gap > 15) {
                        const gapHtml = `<div class="gap-card ml-2 mb-2 border-2 border-dashed border-blue-200 p-2 rounded-lg bg-blue-50/50 flex justify-between items-center transition cursor-pointer action-btn" onclick="openGapModal(${lastEndTime}, ${gap})"><div><span class="text-[9px] font-bold text-blue-400 uppercase tracking-widest block">‚ö° Tiempo Libre</span><span class="text-xs font-bold text-blue-600">${gap} min</span></div><i class="fas fa-plus text-blue-300"></i></div>`;
                        container.insertAdjacentHTML('beforeend', `<div class="relative pl-12 mb-3">${gapHtml}</div>`);
                    }
                    
                    // COPILOT BUBBLE INSERTION
                    const tip = window.getTransitionTip(prevItem, item);
                    if (tip) {
                         container.insertAdjacentHTML('beforeend', `<div class="copilot-bubble"><div class="copilot-icon"><i class="fas fa-robot text-[10px]"></i></div><p>${tip}</p></div>`);
                    }
                }
                
                lastEndTime = item.end ? window.timeToMins(item.end) : startMins + 60;
                const isLive = (!item.end && nowMins >= startMins) || (item.end && nowMins >= startMins && nowMins < window.timeToMins(item.end));
                const liveClass = isLive ? "live-glow" : "";
                const skipClass = item.skipped ? "skipped-card" : "";
                const titleClass = item.skipped ? "skipped-text" : "";

                const html = `<div class="relative pl-16 mb-4 event-card group ${liveClass} ${skipClass}" id="card-${item.id}"><div class="absolute left-0 top-0 w-12 text-right pt-4"><div class="text-xs font-bold text-slate-900 font-mono">${item.start}</div><div class="text-[10px] text-slate-400 font-medium">${item.end || '...'}</div></div><div class="absolute left-[3.5rem] top-6 w-2 h-2 rounded-full bg-white border-2 ${borderClass} z-10 shadow-sm"></div><div class="ml-2 bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden cursor-pointer hover:shadow-md transition action-btn" onclick="openModal('${item.id}')"><div class="p-5 flex justify-between items-start"><div><div class="flex items-center gap-2 mb-1"><span class="text-[9px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full bg-slate-50 text-slate-500 border border-slate-100">${catData.label}</span>${isLive ? '<span class="flex w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>' : ''}</div><h3 class="font-bold text-sm text-slate-800 leading-tight ${titleClass}">${item.title}</h3><p class="text-xs text-slate-500 mt-1 truncate w-40">${item.desc || ''}</p></div><div class="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center ${iconClass}">${iconHTML}</div></div></div></div>`;
                container.insertAdjacentHTML('beforeend', html);
            });
        }

        window.openModal = function(id) {
            const items = appData.weeks[appData.currentWeekId][appData.currentDayKey].items;
            activeEvent = items.find(i => String(i.id) === String(id)); 
            if(!activeEvent) return;

            // Reset delete state
            deleteConfirmState = false;
            const btn = document.getElementById('btn-delete-event');
            if(btn) {
                btn.innerHTML = "BORRAR";
                btn.classList.remove('btn-confirm-delete');
            }

            document.getElementById('modal-title').innerText = activeEvent.title;
            const endTxt = activeEvent.end ? activeEvent.end : "En Progreso";
            document.getElementById('modal-time-range').innerText = `${activeEvent.start} - ${endTxt}`;
            
            window.renderChecklist();
            document.getElementById('view-mode-content').classList.remove('hidden');
            document.getElementById('gap-mode-content').classList.add('hidden');
            document.getElementById('event-form').classList.add('hidden');
            
            const now = window.getNowMins();
            const start = window.timeToMins(activeEvent.start);
            const end = activeEvent.end ? window.timeToMins(activeEvent.end) : start+60;
            document.getElementById('live-controls').classList.toggle('hidden', !(now >= start && now < end));

            const card = document.getElementById('modal-card');
            document.getElementById('modal-overlay').classList.remove('hidden');
            setTimeout(() => card.classList.remove('translate-y-full'), 10);
        }

        window.closeModal = function() {
            const card = document.getElementById('modal-card');
            card.classList.add('translate-y-full');
            setTimeout(() => { document.getElementById('modal-overlay').classList.add('hidden'); activeEvent = null; }, 300);
        }
        
        window.openGapModal = function(startMins, duration) {
            activeGapStart = startMins;
            document.getElementById('gap-duration').innerText = `${duration} min`;
            document.getElementById('view-mode-content').classList.add('hidden');
            document.getElementById('event-form').classList.add('hidden');
            document.getElementById('gap-mode-content').classList.remove('hidden');
            
            const grid = document.getElementById('gap-suggestions-grid');
            grid.innerHTML = "";
            let options = [];
            
            if (duration <= 30) {
                options = [{title: "Flashcards", cat: "estudio", icon: "fa-bolt", desc: "Repaso veloz"}, {title: "Orden R√°pido", cat: "casa", icon: "fa-broom", desc: "Despeja mente"}, {title: "Skincare", cat: "aseo", icon: "fa-spray-can", desc: "Refrescarse"}];
            } else if (duration <= 60) {
                options = [{title: "Siesta T√°ctica", cat: "casa", icon: "fa-bed", desc: "20 min power nap"}, {title: "Lectura", cat: "estudio", icon: "fa-book-open", desc: "Un cap√≠tulo"}, {title: "Adelantar App", cat: "estudio", icon: "fa-code", desc: "Avanzar c√≥digo"}];
            } else {
                options = [{title: "Bloque Estudio", cat: "estudio", icon: "fa-brain", desc: "Sesi√≥n profunda"}, {title: "Gym Express", cat: "fisico", icon: "fa-running", desc: "Rutina corta"}, {title: "Serie TV", cat: "social", icon: "fa-tv", desc: "Descanso total"}];
            }
            
            options.forEach(opt => { 
                grid.innerHTML += `<button onclick="fillGap('${opt.title}', '${opt.cat}')" class="suggestion-card p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-blue-300 hover:bg-blue-50 transition text-left flex items-center gap-4 group w-full"><div class="w-10 h-10 rounded-full bg-slate-100 text-slate-600 flex items-center justify-center group-hover:scale-110 transition"><i class="fas ${opt.icon}"></i></div><div><div class="font-bold text-slate-700 text-sm">${opt.title}</div><div class="text-xs text-slate-400">${opt.desc}</div></div></button>`; 
            });
            document.getElementById('modal-title').innerText = "Oportunidad";
            document.getElementById('modal-time-range').innerText = `Inicio: ${window.minsToTime(startMins)}`;
            const card = document.getElementById('modal-card');
            document.getElementById('modal-overlay').classList.remove('hidden');
            setTimeout(() => card.classList.remove('translate-y-full'), 10);
        }

        window.fillGap = function(title, cat) {
            const newItem = { id: Date.now().toString(), title: title, start: window.minsToTime(activeGapStart), end: null, cat: cat, desc: "Tiempo aprovechado", check: [], skipped: false };
            let items = appData.weeks[appData.currentWeekId][appData.currentDayKey].items;
            items.push(newItem);
            appData.weeks[appData.currentWeekId][appData.currentDayKey].items = items;
            window.saveData();
            window.renderTimeline();
            window.closeModal();
        }

        window.deleteEvent = function(btnElement) {
            if(!activeEvent) return;
            if (!deleteConfirmState) {
                deleteConfirmState = true;
                btnElement.innerHTML = "¬øCONFIRMAR?";
                btnElement.classList.add('btn-confirm-delete');
            } else {
                const k = appData.currentDayKey;
                const wk = appData.currentWeekId;
                appData.weeks[wk][k].items = appData.weeks[wk][k].items.filter(i => String(i.id) !== String(activeEvent.id));
                window.saveData();
                window.renderTimeline();
                window.closeModal();
            }
        }

        window.skipEvent = function() {
            if(!activeEvent) return;
            activeEvent.skipped = !activeEvent.skipped; 
            window.saveData();
            window.renderTimeline();
            window.closeModal();
        }

        window.finishEventNow = function() {
            if(!activeEvent) return;
            const now = new Date();
            activeEvent.end = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            window.saveData();
            window.renderTimeline();
            window.closeModal();
        }

        window.renderChecklist = function() {
            const list = document.getElementById('checklist-container');
            list.innerHTML = "";
            (activeEvent.check || []).forEach((task, idx) => {
                list.innerHTML += `
                    <li class="flex items-center justify-between p-3 bg-slate-50 rounded-xl mb-2 group">
                        <div class="flex items-center gap-3 flex-1 cursor-pointer" onclick="window.toggleCheck(${idx})">
                            <div class="w-5 h-5 rounded border ${task.done ? 'bg-green-500 border-green-500' : 'border-slate-300 bg-white'} flex items-center justify-center transition-colors">
                                ${task.done ? '<i class="fas fa-check text-white text-[10px]"></i>' : ''}
                            </div>
                            <span class="text-sm ${task.done ? 'line-through text-slate-400' : 'text-slate-700'}">${task.text}</span>
                        </div>
                        <div class="flex gap-1 checklist-item-actions">
                            <button onclick="window.removeCheckItem(${idx})" class="w-8 h-8 flex items-center justify-center rounded-full text-slate-300 hover:text-red-500 hover:bg-red-50 transition action-btn">
                                <i class="fas fa-trash-alt text-xs"></i>
                            </button>
                        </div>
                    </li>`;
            });
        }

        window.toggleCheck = function(idx) { activeEvent.check[idx].done = !activeEvent.check[idx].done; window.saveData(); window.renderChecklist(); }
        
        window.removeCheckItem = function(idx) { 
            activeEvent.check.splice(idx, 1); 
            window.saveData(); 
            window.renderChecklist(); 
        }
        
        window.addCheckItem = function() {
            const input = document.getElementById('new-check-item');
            const val = input.value;
            if(val) {
                if(!activeEvent.check) activeEvent.check = [];
                activeEvent.check.push({text: val, done: false});
                input.value = "";
                window.saveData();
                window.renderChecklist();
            }
        }

        window.openAddModal = function() {
            activeEvent = null;
            document.getElementById('view-mode-content').classList.add('hidden');
            document.getElementById('gap-mode-content').classList.add('hidden');
            document.getElementById('event-form').classList.remove('hidden');
            document.getElementById('event-form').reset();
            document.getElementById('warehouse-origin-id').value = "";
            window.renderCategories();
            const card = document.getElementById('modal-card');
            document.getElementById('modal-overlay').classList.remove('hidden');
            setTimeout(() => card.classList.remove('translate-y-full'), 10);
        }

        window.toggleNewCatUI = function() {
            const btn = document.getElementById('btn-add-cat');
            const inputGroup = document.getElementById('input-add-cat-group');
            
            if (inputGroup.classList.contains('hidden')) {
                btn.classList.add('hidden');
                inputGroup.classList.remove('hidden');
                document.getElementById('input-new-cat-name').focus();
            } else {
                btn.classList.remove('hidden');
                inputGroup.classList.add('hidden');
            }
        }

        window.saveNewCategory = function() {
            const nameInput = document.getElementById('input-new-cat-name');
            const emojiInput = document.getElementById('input-new-cat-emoji');
            
            const name = nameInput.value.trim();
            const emoji = emojiInput.value.trim() || "‚ö°"; 
            
            if (!name) { window.toggleNewCatUI(); return; }
            
            const id = name.toLowerCase().replace(/\s+/g, '');
            const colors = ['pink', 'indigo', 'teal', 'orange', 'green', 'blue', 'purple', 'red'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            appData.categories[id] = { label: name, color: color, icon: emoji };
            window.saveData();
            window.renderCategories();
            window.selectCat(id);
            
            nameInput.value = "";
            emojiInput.value = "‚ö°";
            window.toggleNewCatUI();
        }

        window.renderCategories = function() {
            const grid = document.getElementById('category-grid');
            grid.innerHTML = "";
            Object.entries(appData.categories).forEach(([key, val]) => {
                const color = val.color || 'slate';
                const borderColor = `border-${color}-200`;
                const textColor = `text-${color}-600`;
                const bgColor = `bg-${color}-50`;
                
                const iconHTML = val.icon.startsWith('fa-') ? `<i class="fas ${val.icon} text-lg mb-1 opacity-80"></i>` : `<span class="text-lg mb-1 block">${val.icon}</span>`;
                const isDefault = defaultCats[key] !== undefined;
                
                let btnGroup = '';
                if (!isDefault) {
                    btnGroup = `<div onclick="event.stopPropagation(); window.deleteCategory(event, '${key}')" class="cat-delete-btn"><i class="fas fa-times"></i></div>`;
                }

                grid.innerHTML += `
                    <div onclick="window.selectCat('${key}')" class="cat-select cursor-pointer p-2 rounded-xl border ${borderColor} ${bgColor} ${textColor} text-center transition hover:opacity-80 active:scale-95" data-val="${key}">
                        ${btnGroup}
                        ${iconHTML}
                        <span class="block text-[8px] font-bold uppercase truncate">${val.label}</span>
                    </div>`;
            });
        }

        window.selectCat = function(cat) {
            document.getElementById('input-cat').value = cat;
            document.querySelectorAll('.cat-select').forEach(e => e.style.borderWidth = "1px");
            const el = document.querySelector(`.cat-select[data-val="${cat}"]`);
            if(el) el.style.borderWidth = "2px";
        }
        
        window.deleteCategory = function(e, key) {
            e.preventDefault(); 
            if(confirm(`¬øEliminar categor√≠a "${appData.categories[key].label}"?`)) {
                delete appData.categories[key];
                if(document.getElementById('input-cat').value === key) {
                    window.selectCat('casa');
                }
                window.saveData();
                window.renderCategories();
            }
        }

        // ... (resto de funciones Goals/Warehouse igual que antes) ...
        window.openGoalsModal = function() { window.renderGoals(); document.getElementById('goals-card').parentElement.classList.remove('hidden'); setTimeout(()=>document.getElementById('goals-card').classList.remove('translate-y-full'),10); }
        window.closeGoalsModal = function() { document.getElementById('goals-card').classList.add('translate-y-full'); setTimeout(()=>document.getElementById('goals-card').parentElement.classList.add('hidden'),300); }
        window.renderGoals = function() {
            const container = document.getElementById('goals-list-container');
            container.innerHTML = "";
            if(!appData.goals || appData.goals.length === 0) { container.innerHTML = `<div class="text-center p-4 text-slate-400 italic text-xs">No tienes metas a√∫n.</div>`; return; }
            appData.goals.forEach(goal => {
                let stepsHtml = "";
                if(goal.steps && goal.steps.length > 0) { stepsHtml = `<div class="mt-3 pt-3 border-t border-slate-100"><div class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Plan de Acci√≥n</div><ul class="space-y-1">${goal.steps.map(s => `<li class="text-xs text-slate-600 flex items-start gap-2"><i class="fas fa-check text-green-500 mt-0.5"></i><span>${s}</span></li>`).join('')}</ul></div>`; }
                let html = "";
                if (goal.type === 'savings') {
                    const pct = Math.min(100, Math.round((goal.current / goal.target) * 100));
                    html = `<div class="goal-card bg-white p-4 rounded-xl shadow-sm transition"><div class="flex justify-between items-center mb-2"><h4 class="font-bold text-sm text-slate-700"><i class="fas fa-piggy-bank text-yellow-500 mr-2"></i>${goal.title}</h4><button onclick="window.deleteGoal(this, '${goal.id}')" class="text-slate-300 hover:text-red-400 px-2 action-btn"><i class="fas fa-trash-alt text-xs"></i></button></div><div class="relative w-full bg-slate-100 h-4 rounded-full overflow-hidden mb-2"><div class="bg-green-500 h-full rounded-full progress-bar-striped" style="width: ${pct}%"></div><span class="absolute inset-0 flex items-center justify-center text-[9px] font-bold text-slate-600">${pct}%</span></div><div class="flex justify-between items-center"><span class="text-xs font-mono text-slate-600">S/ ${goal.current} / S/ ${goal.target}</span><button onclick="window.updateSavings('${goal.id}')" class="w-8 h-8 bg-green-100 text-green-700 rounded-full flex items-center justify-center hover:bg-green-200 action-btn"><i class="fas fa-plus text-xs"></i></button></div>${stepsHtml}</div>`;
                } else {
                    const doneClass = goal.done ? 'done bg-slate-100' : 'bg-white';
                    html = `<div class="goal-card ${doneClass} p-4 rounded-xl shadow-sm transition"><div class="flex justify-between items-start"><div class="flex items-center gap-3"><div class="w-6 h-6 rounded-full border-2 ${goal.done?'bg-yellow-500 border-yellow-500':'border-slate-300'} flex items-center justify-center cursor-pointer transition shrink-0 action-btn" onclick="window.toggleGoal('${goal.id}')">${goal.done ? '<i class="fas fa-check text-white text-xs"></i>' : ''}</div><div><h4 class="font-bold text-sm text-slate-700">${goal.title}</h4></div></div><div class="flex gap-2"><button onclick="window.generateGoalPlan('${goal.id}')" class="text-indigo-400 hover:text-indigo-600 px-1 action-btn"><i class="fas fa-magic text-xs"></i></button><button onclick="window.deleteGoal(this, '${goal.id}')" class="text-slate-300 hover:text-red-400 px-1 action-btn"><i class="fas fa-trash-alt text-xs"></i></button></div></div>${stepsHtml}</div>`;
                }
                container.insertAdjacentHTML('beforeend', html);
            });
        }
        window.addNewGoal = function() {
            const title = document.getElementById('new-goal-title').value; if(!title) return;
            const newGoal = { id: Date.now().toString(), title: title, type: newGoalType, done: false, steps: [] };
            if (newGoalType === 'savings') { newGoal.target = parseFloat(document.getElementById('new-goal-target').value)||0; newGoal.current = parseFloat(document.getElementById('new-goal-current').value)||0; }
            if(!appData.goals) appData.goals = []; appData.goals.push(newGoal); document.getElementById('new-goal-title').value = ""; window.saveData(); window.renderGoals();
        }
        window.deleteGoal = function(btn, id) { if (btn.classList.contains('text-red-600')) { appData.goals = appData.goals.filter(g => String(g.id) !== String(id)); window.saveData(); window.renderGoals(); } else { const originalContent = btn.innerHTML; btn.innerHTML = `<span class='text-[8px] font-bold'>¬øSEGURO?</span>`; btn.classList.remove('text-slate-300'); btn.classList.add('text-red-600', 'bg-red-50', 'rounded-lg', 'px-1'); setTimeout(() => { if (btn) { btn.innerHTML = originalContent; btn.classList.add('text-slate-300'); btn.classList.remove('text-red-600', 'bg-red-50', 'rounded-lg', 'px-1'); } }, 3000); } }
        window.toggleGoal = function(id) { const goal = appData.goals.find(g => String(g.id) === String(id)); if(goal) { goal.done = !goal.done; window.saveData(); window.renderGoals(); } }
        window.updateSavings = function(id) { const amount = parseFloat(prompt("Monto:")); const goal = appData.goals.find(g => String(g.id) === String(id)); if(goal && !isNaN(amount)) { goal.current += amount; window.saveData(); window.renderGoals(); } }
        window.generateGoalPlan = async function(id) { const goal = appData.goals.find(g => String(g.id) === String(id)); if(!goal) return; const btn = event.currentTarget; const originalHTML = btn.innerHTML; btn.innerHTML = `<i class="fas fa-spinner fa-spin text-indigo-500"></i>`; setTimeout(() => { goal.steps = ["Paso 1: Planificar", "Paso 2: Ejecutar", "Paso 3: Revisar"]; window.saveData(); window.renderGoals(); }, 1000); }
        window.toggleGoalType = function(type) { newGoalType = type; const btnSimple = document.getElementById('btn-type-simple'); const btnSavings = document.getElementById('btn-type-savings'); if (type === 'simple') { btnSimple.className = "action-btn flex-1 py-3 rounded-lg text-sm font-bold bg-slate-900 text-white transition shadow-sm"; btnSavings.className = "action-btn flex-1 py-3 rounded-lg text-sm font-bold text-slate-400 hover:bg-slate-50 transition"; document.getElementById('savings-inputs').classList.add('hidden'); } else { btnSimple.className = "action-btn flex-1 py-3 rounded-lg text-sm font-bold text-slate-400 hover:bg-slate-50 transition"; btnSavings.className = "action-btn flex-1 py-3 rounded-lg text-sm font-bold bg-slate-900 text-white transition shadow-sm"; document.getElementById('savings-inputs').classList.remove('hidden'); } }
        
        window.openWarehouseModal = function() { window.renderWarehouse(); document.getElementById('warehouse-card').parentElement.classList.remove('hidden'); setTimeout(()=>document.getElementById('warehouse-card').classList.remove('translate-y-full'),10); }
        window.closeWarehouseModal = function() { document.getElementById('warehouse-card').classList.add('translate-y-full'); setTimeout(()=>document.getElementById('warehouse-card').parentElement.classList.add('hidden'),300); }
        window.addToWarehouse = function() { const input = document.getElementById('warehouse-input'); const val = input.value.trim(); if(val) { const cat = document.getElementById('warehouse-cat-select').value; appData.warehouse.push({ id: Date.now().toString(), text: val, cat: cat, date: new Date().toLocaleDateString('es-ES') }); input.value = ""; window.saveData(); window.renderWarehouse(); } }
        window.deleteWarehouseItem = function(id) { appData.warehouse = appData.warehouse.filter(i => String(i.id) !== String(id)); window.saveData(); window.renderWarehouse(); }
        window.renderWarehouse = function() { const list = document.getElementById('warehouse-list'); list.innerHTML = ""; let items = appData.warehouse; if(activeFilter !== 'all') items = items.filter(i => i.cat === activeFilter); const catConfig = { ideas: { color: "yellow", icon: "fa-lightbulb", label: "Idea" }, compras: { color: "green", icon: "fa-shopping-cart", label: "Compra" }, links: { color: "blue", icon: "fa-link", label: "Link" }, otros: { color: "purple", icon: "fa-box", label: "Varios" } }; items.slice().reverse().forEach(item => { const conf = catConfig[item.cat] || catConfig.otros; list.innerHTML += `<div class="warehouse-card bg-white p-4 rounded-2xl border border-slate-100 shadow-sm flex items-start gap-3 group"><div class="w-8 h-8 rounded-full bg-${conf.color}-50 text-${conf.color}-500 flex items-center justify-center shrink-0"><i class="fas ${conf.icon} text-xs"></i></div><div class="flex-1"><p class="text-slate-800 font-medium text-sm leading-snug">${item.text}</p><span class="text-[10px] text-slate-400 font-bold mt-1 inline-block">${conf.label} ‚Ä¢ ${item.date}</span></div><div class="flex gap-1"><button onclick="window.planWarehouseItem('${item.id}')" class="w-8 h-8 rounded-full bg-slate-50 text-slate-400 flex items-center justify-center hover:bg-indigo-50 hover:text-indigo-500 transition action-btn"><i class="fas fa-calendar-plus text-[10px]"></i></button><button onclick="window.editWarehouseItem('${item.id}')" class="w-8 h-8 rounded-full bg-slate-50 text-slate-400 flex items-center justify-center hover:bg-slate-100 hover:text-slate-600 transition action-btn"><i class="fas fa-pen text-[10px]"></i></button><button onclick="window.deleteWarehouseItem('${item.id}')" class="w-8 h-8 rounded-full bg-slate-50 text-slate-400 flex items-center justify-center hover:bg-red-50 hover:text-red-400 transition action-btn"><i class="fas fa-times text-[10px]"></i></button></div></div>`; }); }
        window.planWarehouseItem = function(id) { const item = appData.warehouse.find(i => String(i.id) === String(id)); if(item) { window.closeWarehouseModal(); setTimeout(() => { window.openAddModal(); document.getElementById('input-title').value = item.text; document.getElementById('warehouse-origin-id').value = id; }, 350); } }
        window.editWarehouseItem = function(id) { const item = appData.warehouse.find(i => String(i.id) === String(id)); if(item) { const txt = prompt("Editar:", item.text); if(txt) { item.text = txt; window.saveData(); window.renderWarehouse(); } } }
        window.filterWarehouse = function(filter) { activeFilter = filter; window.renderWarehouse(); document.querySelectorAll('#warehouse-tags button').forEach(b => { b.className = `action-btn px-4 py-2 rounded-full text-xs font-bold shrink-0 transition ${b.id === 'filter-'+filter ? 'bg-slate-900 text-white' : 'bg-slate-100 text-slate-500'}`; }); }
        window.setupEventListeners = function() { document.getElementById('event-form').addEventListener('submit', (e) => { e.preventDefault(); const id = document.getElementById('event-id').value; const whId = document.getElementById('warehouse-origin-id').value; const newEvt = { id: id ? id : Date.now().toString(), title: document.getElementById('input-title').value, start: document.getElementById('input-start').value, end: document.getElementById('input-end').value || null, cat: document.getElementById('input-cat').value, desc: "Manual", check: activeEvent ? activeEvent.check : [], skipped: activeEvent ? activeEvent.skipped : false }; let items = appData.weeks[appData.currentWeekId][appData.currentDayKey].items; if(id) items = items.filter(i => String(i.id) !== String(id)); items.push(newEvt); appData.weeks[appData.currentWeekId][appData.currentDayKey].items = items; if(whId) appData.warehouse = appData.warehouse.filter(i => String(i.id) !== String(whId)); window.saveData(); window.renderTimeline(); window.closeModal(); }); }
        window.setupSwipe = function() { const el = document.getElementById('main-scroll'); el.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; }, {passive: true}); el.addEventListener('touchend', e => { touchEndX = e.changedTouches[0].screenX; if(touchEndX < touchStartX - 50) window.changeDay(1); else if(touchEndX > touchStartX + 50) window.changeDay(-1); }, {passive: true}); }
        window.changeDay = function(dir) { const days = ['lunes', 'martes', 'miercoles', 'jueves', 'viernes', 'sabado', 'domingo']; const idx = days.indexOf(appData.currentDayKey); const next = idx + dir; if(next >= 0 && next < 7) { appData.currentDayKey = days[next]; window.render(); } }
        window.updateHeader = function() { const elTitle = document.getElementById('day-display-title'); if(elTitle) elTitle.innerText = appData.currentDayKey; const weekIdx = parseInt(appData.currentWeekId.split('-')[1]) - 1; const d = new Date(YEAR_START_DATE); d.setDate(d.getDate() + (weekIdx * 7) + dayMap[appData.currentDayKey]); const elDate = document.getElementById('date-display'); if(elDate) elDate.innerText = d.toLocaleDateString('es-ES', {weekday:'short', day:'numeric'}); const elSubtitle = document.getElementById('day-display-subtitle'); if(elSubtitle) elSubtitle.innerText = appData.weeks[appData.currentWeekId][appData.currentDayKey].title || "D√≠a Est√°ndar"; const elWkLabel = document.getElementById('current-week-label'); if(elWkLabel) elWkLabel.innerText = `Semana ${weekIdx+1}`; const startWk = new Date(YEAR_START_DATE); startWk.setDate(startWk.getDate() + (weekIdx * 7)); const endWk = new Date(startWk); endWk.setDate(endWk.getDate() + 6); const elWkDate = document.getElementById('current-week-date'); if(elWkDate) elWkDate.innerText = `${startWk.toLocaleDateString('es-ES',{day:'numeric', month:'short'})} - ${endWk.toLocaleDateString('es-ES',{day:'numeric', month:'short'})}`; const now = new Date(); const pucp = new Date(2026, 1, 15); const fire = new Date(2026, 1, 28); const elPucp = document.getElementById('days-pucp'); const elFire = document.getElementById('days-fire'); if (elPucp) elPucp.innerText = Math.max(0, Math.ceil((pucp - now)/86400000)) + "d"; if (elFire) elFire.innerText = Math.max(0, Math.ceil((fire - now)/86400000)) + "d"; const todayItems = appData.weeks[appData.currentWeekId][appData.currentDayKey].items; let firstStartMins = 5 * 60; let lastEndMins = 23 * 60; if (todayItems.length > 0) { const starts = todayItems.map(i => window.timeToMins(i.start)); const ends = todayItems.map(i => i.end ? window.timeToMins(i.end) : window.timeToMins(i.start) + 60); firstStartMins = Math.min(...starts); lastEndMins = Math.max(...ends); } const currentMins = window.getNowMins(); const totalDuration = lastEndMins - firstStartMins; let pct = 0; if (totalDuration > 0) pct = Math.max(0, Math.min(100, ((currentMins - firstStartMins) / totalDuration) * 100)); const elProgress = document.getElementById('day-progress'); if(elProgress) elProgress.style.width = `${pct}%`; }
        window.jumpToCurrentWeek = function() { window.setCurrentDay(); window.render(); }
        window.toggleWeekMenu = function() { document.getElementById('week-menu').classList.toggle('hidden'); }
        window.renderWeekMenu = function() { const c = document.getElementById('week-list-container'); c.innerHTML = ""; Object.keys(appData.weeks).forEach((k,i) => c.innerHTML += `<button onclick="switchWeek('${k}')" class="w-full text-left p-2 border-b text-sm">Semana ${i+1}</button>`); }
        window.switchWeek = function(k) { appData.currentWeekId = k; window.toggleWeekMenu(); window.render(); }
        window.renderNav = function() { const c = document.getElementById('bottom-nav'); c.innerHTML = Object.keys(dayLabels).map(k => `<button onclick="appData.currentDayKey='${k}'; render();" class="flex flex-col items-center min-w-[50px] p-2 rounded-xl ${appData.currentDayKey===k?'bg-slate-900 text-white':'text-slate-400'}"><span class="text-[10px] font-bold uppercase">${dayLabels[k]}</span></button>`).join(''); }
        window.enableEditMode = function() { document.getElementById('view-mode-content').classList.add('hidden'); document.getElementById('event-form').classList.remove('hidden'); document.getElementById('input-title').value = activeEvent.title; document.getElementById('input-start').value = activeEvent.start; document.getElementById('input-end').value = activeEvent.end || ""; document.getElementById('event-id').value = activeEvent.id; window.selectCat(activeEvent.cat); }
        window.generateStrategy = async function() { if (!activeEvent) return; const btn = document.getElementById('ai-btn'); const originalContent = btn.innerHTML; btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> PENSANDO...`; setTimeout(() => { const title = activeEvent.title.toLowerCase(); let tasks = ["Preparar material", "Revisar estado", "Ejecutar con foco", "Limpiar zona"]; if(title.includes("estudio") || title.includes("pucp")) tasks = ["Celular en modo avi√≥n", "Agua y snacks listos", "Revisar temario hoy", "Cron√≥metro 50/10"]; else if(title.includes("running") || title.includes("gym")) tasks = ["Llenar botella agua", "Playlist activada", "Reloj GPS listo", "Estiramiento din√°mico"]; else if(title.includes("bomba") || title.includes("guardia")) tasks = ["Uniforme completo", "Botas lustradas", "DNI en bolsillo", "Avisar llegada"]; else if(title.includes("cocina") || title.includes("chef")) tasks = ["Sacar ingredientes", "Despejar mesa", "Bolsas basura listas", "Tupperwares a mano"]; if(!activeEvent.check) activeEvent.check = []; tasks.forEach(t => { if(!activeEvent.check.some(e => e.text === t)) activeEvent.check.push({text: t, done: false}); }); window.saveData(); window.renderChecklist(); btn.innerHTML = `<i class="fas fa-check"></i> LISTO`; setTimeout(() => { btn.innerHTML = originalContent; }, 2000); }, 800); }
        window.generateDailyBriefing = async function() { const container = document.getElementById('ai-briefing-container'); const content = document.getElementById('ai-briefing-text'); container.classList.remove('hidden'); content.innerHTML = "<i class='fas fa-spinner fa-spin'></i> Analizando..."; setTimeout(() => { const day = appData.currentDayKey; const quotes = { lunes: "Inicio de semana. Actitud de combate.", martes: "Persistencia. El dolor de hoy es la fuerza de ma√±ana.", miercoles: "Mitad de camino. No bajes la guardia.", jueves: "Servicio y sacrificio.", viernes: "√öltimo empuj√≥n.", sabado: "Recarga estrat√©gica.", domingo: "Guardia alta." }; content.innerHTML = `<strong>${day.toUpperCase()}:</strong> ${quotes[day]}<br>Objetivo: Cumplir el horario al 100%.`; }, 800); }
        
        window.init();
    </script>
</body>
</html>